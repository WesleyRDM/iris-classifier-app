<!DOCTYPE html>
<html>
<head>
    <title>Iris Predictor</title>
</head>
<body>
    <h1>Predict Iris Class</h1>
    <form id="iris-form">
        <label>Sepal Length: <input type="number" step="0.1" name="sepal_length" required></label><br>
        <label>Sepal Width: <input type="number" step="0.1" name="sepal_width" required></label><br>
        <label>Petal Length: <input type="number" step="0.1" name="petal_length" required></label><br>
        <label>Petal Width: <input type="number" step="0.1" name="petal_width" required></label><br>
        <button type="submit">Predict</button>
    </form>

    <h2>Prediction:</h2>
    <p id="result"></p>
    <img id="plot" src="" alt="Plot will appear here">

    <script>
        const form = document.getElementById("iris-form");
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const data = {
                sepal_length: parseFloat(form.sepal_length.value),
                sepal_width: parseFloat(form.sepal_width.value),
                petal_length: parseFloat(form.petal_length.value),
                petal_width: parseFloat(form.petal_width.value)
            };

            try {
                const response = await fetch("http://127.0.0.1:8000/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.error) {
                    document.getElementById("result").innerText = "Error: " + result.error;
                    document.getElementById("plot").src = "";
                } else {
                    document.getElementById("result").innerText = `Class: ${result.predicted_name} (${result.predicted_class})`;
                    document.getElementById("plot").src = `data:image/png;base64,${result.plot_base64}`;
                }
            } catch (err) {
                document.getElementById("result").innerText = "Error connecting to API";
                document.getElementById("plot").src = "";
            }
        });
    </script>
</body>
</html>